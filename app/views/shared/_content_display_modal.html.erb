<div id="<%= content.id %>" tabindex="-1" aria-hidden="true"
  class="fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full">
  <div class="relative w-full max-w-2xl max-h-full">
    <!-- Modal content -->
    <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
      <!-- Modal header -->
      <div class="flex items-start justify-between p-4 border-b rounded-t dark:border-gray-600">
        <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
          <%= content.title %>
        </h3>
        <button type="button"
          class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ml-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white"
          data-modal-hide="<%= content.id %>">
          <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
          </svg>
          <span class="sr-only">Close modal</span>
        </button>
      </div>
      <!-- Modal body -->
      <div class="p-6 space-y-6">
        <% if content.data.present? %>
          <% if content.type == 'application/pdf' %>
            <embed src="data:application/pdf;base64,<%= content.data %>" type="application/pdf" width="100%" height="600px">
          <% elsif content.type == 'text/plain' %>
            <div class="whitespace-pre-wrap font-mono bg-gray-100 p-4 rounded">
              <%= Base64.decode64(content.data) %>
            </div>
          <% elsif content.type == 'text/html' %>
            <div class="content-html-container">
              <%= Base64.decode64(content.data).html_safe %>
            </div>
          <% elsif content.type.start_with?('image/') %>
            <img src="data:<%= content.type %>;base64,<%= content.data %>" alt="<%= content.title %>" class="max-w-full h-auto">
          <% elsif content.type == 'application/json' %>
            <div class="whitespace-pre-wrap font-mono bg-gray-100 p-4 rounded">
              <% begin %>
                <%= JSON.pretty_generate(JSON.parse(Base64.decode64(content.data))) %>
              <% rescue %>
                <%= Base64.decode64(content.data) %>
              <% end %>
            </div>
          <% elsif content.type == 'application/xml' || content.type == 'text/xml' %>
            <div class="whitespace-pre-wrap font-mono bg-gray-100 p-4 rounded">
              <%= Base64.decode64(content.data) %>
            </div>
          <% else %>
            <div class="p-4 bg-yellow-100 text-yellow-800 rounded">
              <p>Unsupported content type: <%= content.type %></p>
              <p class="mt-2">Content is available but cannot be displayed in this viewer.</p>
              <a href="<%= content_path(id: content.id, download: true) %>" class="mt-2 inline-block px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                Download Content
              </a>
            </div>
          <% end %>
        <% elsif content.url.present? %>
          <% if content.type == 'application/pdf' %>
            <iframe src="<%= content_path(id: content.id) %>" width="100%" height="600px">
              This browser does not support PDFs. Please download the PDF to view it: <a href="<%= content_path(id: content.id) %>">Download PDF</a>.
            </iframe>
          <% elsif content.type.start_with?('image/') %>
            <img src="<%= content_path(id: content.id) %>" alt="<%= content.title %>" class="max-w-full h-auto">
          <% else %>
            <div class="p-4 bg-yellow-100 text-yellow-800 rounded">
              <p>Content is available at the following URL:</p>
              <a href="<%= content.url %>" target="_blank" class="mt-2 inline-block px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                Open Content
              </a>
              <p class="mt-2">Or view it directly:</p>
              <a href="<%= content_path(id: content.id) %>" target="_blank" class="mt-2 inline-block px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                View Content
              </a>
            </div>
          <% end %>
        <% else %>
          <div class="p-4 bg-red-100 text-red-800 rounded">
            No content data or URL available.
          </div>
        <% end %>
      </div>
      <!-- Modal footer -->
      <div class="flex items-center justify-end p-6 space-x-2 border-t border-gray-200 rounded-b dark:border-gray-600">
        <button data-modal-hide="<%= content.id %>" type="button"
          class="text-gray-200 bg-gray-500 hover:bg-gray-600 focus:ring-4 focus:outline-none focus:ring-gray-600 rounded-lg border border-gray-500 text-sm font-medium px-5 py-2.5 hover:text-white focus:z-10">Close</button>
      </div>
    </div>
  </div>
</div>
